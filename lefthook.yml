assert_lefthook_installed: true
files: git diff --name-only master

pre-commit:
  parallel: true
  jobs:
    - name: staticcheck
      glob: "*.go"
      run: staticcheck ./...
    - name: err-check
      glob: "*.go"
      run: errcheck ./...
    - name: golangci-lint
      glob: "*.go"
      stage_fixed: true
      run: golangci-lint run --lint
    - name: go-test
      glob: "*.go"
      run: go test ./...
pre-push:
  parallel: true
  jobs:
    - name: delve-test
      glob: "*.go"
      run: dlv test ./... --headless --listen=:40000 --log
    - name: pprof-test
      glob: "*.go"
      run: go test -cpuprofile=cpu.out -memprofile=mem.out ./...
